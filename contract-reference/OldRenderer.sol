// SPDX-License-Identifier: GPL-3.0

import "./Base64.sol";

// temporary, delete before launch
import "hardhat/console.sol";

pragma solidity ^0.8.0;

contract FootyRenderer {
    string[] public palette = [
        "#000000",
        "#000001",
        "#FFFFFF",
        "#BCBDBC",
        "#01C953",
        "#FE5722",
        "#2196F2",
        "#FFEF16",
        "#757574",
        "#424342",
        "#F9F4E6",
        "#F78A18",
        "#FFE939",
        "#F7913D",
        "#D9391F",
        "#F8DDB0",
        "#4D271B",
        "#D5D7E1",
        "#4DAF50",
        "#F54237",
        "#FEEB3B",
        "#D4860A",
        "#FFCA28",
        "#000014",
        "#FF7F00",
        "#B66D00",
        "#FFFF00",
        "#7F3300",
        "#FF0000",
        "#380000",
        "#8B4500",
        "#7F7F00",
        "#558B2F",
        "#32691F",
        "#004E13",
        "#DFDF1F",
        "#8BC34A",
        "#009688",
        "#FCD835",
        "#837716",
        "#D32E2E",
        "#9E9C24",
        "#BBDFFA",
        "#FE1644",
        "#3F51B5",
        "#1565C0",
        "#C72829",
        "#D40000",
        "#2979FE",
        "#0D46A1",
        "#B71C1C",
        "#E43834",
        "#01BDD5",
        "#1B227F",
        "#388F3D",
        "#FFC006",
        "#1976D3",
        "#283593",
        "#42A146",
        "#2963FE",
        "#AFB42A",
        "#65FFDA",
        "#DD2D00",
        "#FEF076",
        "#81D4FB",
        "#212121",
        "#0377BD",
        "#FFECB3",
        "#004C41",
        "#EEEEEF",
        "#03A8F4",
        "#FE0E0F",
        "#FF638D",
        "#C2195B",
        "#D81B60",
        "#E91E62",
        "#EC417A",
        "#0ADC4D",
        "#1929F4",
        "#2B83F6",
        "#5648ED",
        "#8DD122",
        "#068940",
        "#257CED",
        "#254EFB",
        "#9CB4B8",
        "#E8705B",
        "#D19A54",
        "#B9185C",
        "#FE500C",
        "#CC0595",
        "#AB36BE",
        "#F3322C",
        "#D7D3CD",
        "#FDF8FF",
        "#4BEA69",
        "#FFC110",
        "#F98F30",
        "#FF9901"
    ];

    string[] public backgrounds = ["#E1D7D5", "#D5D7E1"];

    bytes[] public heads = [
        bytes(
            hex"4e01040219010a021401030201030602010303021101030203030402030303020f010502080305020e010502080305020e010502080305020d0105020a0305020c0103020e0303020c010102120301020b01020207030502060302020a01020206030702050302020a01020206030702050302020b01010206030702050301020c01010206030702050301020d01020205030502040302020e01040204030302030304020f010402080304021101040206030402ff01"
        ),
        bytes(
            hex"4e010204020519010304050502031401020303060105050302070103110102030406010404030207020301040f01020302060203010605030107030302040e01010302060203020604030207040301040e010206020303060104030302070104030301040d0101040105020302060207010402030307040502030c010104020501030206030702030207060501030c010104020502060303040703050203020501030b01010402030105060302070106010504030104020501040a010104010302080803020604030204010301040a0101040105010809030106080301040b0101050903020608030c010103010502070503020609030d01020304070103020604030206010502030e010104020303070206010403030306020501030f0101040203030702040103030603030105110104030107020302060503ff01"
        ),
        bytes(
            hex"4e010402190101020109020402030202010a0102140102020109010a010401090104020301020109020a010211010102010a0109010a020901040403010201040109020a0f010302020a0209010406030204010901020e010202010a0102020a010209030102010a0e01010202030202010a0b0301020d010102040302020403020203040203010401020c0102020803020201090102010a010901040103010401020c010102080302020209010a02090104010302090b01010208030402010a01090102010901040203010a01020a01010207030202010a0102010a0109010a0109010201040203010a01020a010202010a010904030202020a0109010a01090204030302020b01020a0104010904030202010a0102010901020104040301020c0101020204010901040e0301020d010102010a020901040c0301020e010102020a0104010201040a03010a01020f010102010a01020109010208030102020911010202010a0109010205030404ff01"
        ),
        bytes(
            hex"4b01020b0201030b18010b0b14010f0b11010f0b1001110b0f01010b010c0c0b010d020b1001020c010e020b010e020f050b010d010b0e010310020c010e020f010e020f010e010f020b010e010d010b0e010310030c020f010e020f010e020f020e010d0f0102100101030c020f010e020f010e020f020e010d0f0102100101030c020f010e020f010e020f020e010d0f0102100101030c020f010e020f010e020f020e010d0f0102100101030c020f010c020f010e020f020e010d0f0102100101030c020f010c020f010e020f020e010d0f010310030c020f010c020f010e020f020e010d10010210030c020f010c020f010c020f020e010d12010c0c010e010d120105100711021012010e10ff01"
        ),
        bytes(
            hex"c70114030b010203010401120104011201040112010401120104011201040112010401120104011201040112020309011503011201030901010301040103010401120104011201040112010401120104011201040112010401120104011201040103010401030901010301120103011201040112010401120104011201040112010401120104011201040112010401120103011201030901010301040103010401120104011201040112010401120104011201040112010401120104011201040103010401030901010301120103011201040112010401120104011201040112010401120104011201040112010401120103011201030901010301040103010401120104011201040112010401120104011201040112010401120104011201040103010401030901010301120103011201040112010401120104011201040112010401120104011201040112010401120103011201030901010301040103010401120104011201040112010401120104011201040112010401120104011201040103010401030901010301120103011201040112010401120104011201040112010401120104011201040112010401120103011201030901010301040103010401120104011201040112010401120104011201040112010401120104011201040103010401030901010301120103011201040112010401120104011201040112010401120104011201040112010401120103011201030901010301040103010401120104011201040112010401120104011201040112010401120104011201040103010401030901010301120103011201040112010401120104011201040112010401120104011201040112010401120103010101030901010313010103ff01"
        ),
        bytes(
            hex"c5011703090101030a1301030a130103090101030a1301030a13010309010503061301030613050309010103031301030613010306130103031301030901010303130103051303030513010303130103090103030113010304130103011301030113010304130103011303030901010301130103011301030413010301130103011301030413010301130103011301030901030301130103041301030113010301130103041301030113030309010103031301030513030305130103031301030901010303130103061301030613010303130103090105030613010306130503090101030a1301030a130103090101030a1301030a13010309011703ff01"
        ),
        bytes(
            hex"4a010a1415010c1414010c14011513010c14011513010c14011513010c14010d13010c14011513010c14011513010c14011513010c14011513010c14010d13010c14011513010c14011513010c14011513010c14011513010c14011514010a140115010d15010215010d0215010d051516010515020d0115010dff01"
        ),
        bytes(
            hex"4a010a1415010c1414010c14011513010c140115010d12010c14021512010c14010d011512010c14021512010c14021512010c14021512010c14021512010c14021512010c14021512010c14021512010c140115010d12010c14021512010c14021513010a14031514010115020d0115010d0315010d021516010615010d0115010dff01"
        ),
        bytes(
            hex"4f0103161c01041601171a01061601171801011601170516021717010117071601171701011703160117031601171701031601170216011702161701031601170116011703161801021601170116011702161a0101170116011702161b0101160217021601181701011902010216011702160101011a1601011b02010116011703160101011c1601011d02010116021702160101011e1601011d0201021703160101011f1601012002010121031601211a010122011603210116012218010221012203160122022118010221032202210123370101241e01011bff01"
        )
    ];

    bytes[] public kits = [
        bytes(
            hex"ff01ff01ab010e2512010e2512010a250126011402251201092501260114020301251201022501010625012601140203012512010225010107250126011402251201022501010b251201022501010b251201022501010b251201022501010b251201022501010b25"
        ),
        bytes(
            hex"ff01ff01ab01010302070203020702030207020301071201010302070203020702030207020301071201010302070203020702030207020301071201010302070203020702030207020301071201010301070101020302070203020702030107120101030107010102030207020302070203010712010103010701010203020702030207020301071201010301070101020302070203020702030107120101030107010102030207020302070203010712010103010701010203020702030207020301071201010301070101020302070203020702030107"
        ),
        bytes(
            hex"ff01ff01ab010427071303271201062703130527120107270113062712010a2701280103022712010227010106270228020301271201022701010b271201022701010b271201022701010b271201022701010b271201022701010a27011312010213010109270213"
        ),
        bytes(
            hex"ff01ff01ab01022909140329120102290814010203291201022907140102012a010202291201022906140102012a0102012a010201291201022901010514012a0303012a0129120102290101061403020229120102290101051401020114010201140102012912010229010109140229120102290101091402291201022901010914022912010229010109140229"
        ),
        bytes(
            hex"ff01ff01ab010e2b12010e2b12010a2b010201150114012b12010b2b0115022b1201022b01010b2b1201022b01010b021201022b01010615010d0315010d1201022b01010b141201022b01010b2b1201022b01010b2b1201022b01010b2b"
        ),
        bytes(
            hex"ff01ff01ab010115010d0215010d05130315010d12010215030d0315020d0215020d12010a15010701030107011512010115010d0315010d0315011303030113120102150101010d0615010701030107010d1201021501010215020d0315010d0113021512010115010d01010215010d051501130115010d1201020d0101010d0815020d1201021501010315010d0115010d05151201021501010215010d0115010d0515010d120102150101010d0115010d0815"
        ),
        bytes(
            hex"ff01ff01ab0103290b0312010b030129020312010a030329010312010a0303020103120102030101070301290103012901031201020301010b031201020301010b031201020301010b031201020301010b031201020301010a03012912010229010109030229"
        ),
        bytes(
            hex"ff01ff01ab01052c0503042c1201052c0103032c0103042c12010b2c012d022c12010a2c012d0103012d012c1201022c0101082c012d022c1201022c01010b2c1201022c01010b2c1201022c01010b2c1201022c01010b2c1201022c01010a2c012d1201022e0101092c022d"
        ),
        bytes(
            hex"ff01ff01ab010215030d0515010d031512010315010d0615012f031512010115010d0115010d0115010d0115010d0115012f0103012f02151201031501290615012f02150129120102150101012e01290415010d02150129012e120102150101012f012e012905150129012e012f1201010d0115010101150129012e0415010d012e012f010d1201021501010215012f0415010d012f010d01151201021501010515010d0115010d03151201021501010115010d0115020d0315010d02151201021501010215010d0215010d0315010d0115"
        ),
        bytes(
            hex"ff01ff01ab0105300503043012010e3012010a30023102301201093001310103013001310130120102300101063001310130010302301201023001010730013103301201023001010b301201023001010b301201023001010b301201023001010b301201023001010b30"
        ),
        bytes(
            hex"ff01ff01ab01022c0303042c0203032c12010203032c0303032c030312010203032c0303032c030312010203032c0303032c03031201022c01010203032c0303032c1201022c01010203032c0303032c1201022c01010203032c0303032c120102030101022c0303032c0303120102030101022c0303032c0303120102030101022c0303032c03031201022c01010203032c0303032c"
        ),
        bytes(
            hex"ff01ff01ab0105290503042912010329090302291201032901320503013204031201032903320303013202290203120102290101053203030129020312010229010107320303012912010229010107320429120102290101053206291201022901010332082912010229010101320a291201022901010b29"
        ),
        bytes(
            hex"ff01ff01ab010433063404331201033308340333120102330a3402331201013308340103033401331201023401010534040302341201023401010634010304341201023401010b341201023401010b341201023401010b341201023401010b341201023401010b34"
        ),
        bytes(
            hex"ff01ff01ab010e35120108350103053512010735010301020103043512010835010305351201023501010b351201023501010b341201023501010b031201023501010b021201023501010b351201023501010b351201023501010b35"
        ),
        bytes(
            hex"ff01ff01ab010e0312010e03120109030307020312010903012f0103012f02031201020301010603030702031201020301010603012f0103012f02031201020301010703010703031201020301010b031201020301010b031201020301010b031201020301010b03"
        ),
        bytes(
            hex"ff01ff01ab0105360507043612010e3612010a360103033612010a2f0203022f1201022f0101082f0103022f12010136010701010736010301360103013612010136010701010b3612010136010701010b3612010136010701010b3612010136010701010b3612010136010701010b36"
        ),
        bytes(
            hex"ff01ff01ab010e0312010e0312010e0312010e03120102020101020202030702120102300101023002020730120102150101021502300215010d04151201020301010203021507031201020301010b031201020301010b031201020301010b03"
        ),
        bytes(
            hex"ff01ff01ab01042e0207082e1201042e0207042e0103032e120108070503010712010e071201022e0101012e0207022e0103012e0103012e0103012e1201022e0101012e0207022e0103012e0103012e0103012e1201020701010b071201020701010b071201022e0101012e0207082e1201022e0101012e0207082e1201020701010b07"
        ),
        bytes(
            hex"ff01ff01ab0104340737033412010334023005030330013412010a34023802341201023403300103043001030330120102340101013401030130010303340130010302341201023401010230010304300103013702301201023401010b341201023401010b301201023401010b341201023001010b301201023001010b34"
        ),
        bytes(
            hex"ff01ff01ab010e0312010e03120109030313020312010a03012f03031201020301010603032f02031201020301010b031201020301010b031201020301010b031201020301010b031201021301010b031201022f01010b03"
        ),
        bytes(
            hex"ff01ff01ab01053905360439120106390336053912010a3901050103012f013912010a3901050103012f01391201023901010839010302391201023901010b391201023901010b391201023901010b391201023901010b391201023901010b391201023601010b39"
        ),
        bytes(
            hex"ff01ff01ab01013a01030a3a0103013a120101030c3a01031201093a0303023a1201093a0103012f0103023a1201023a0101063a0303023a1201023a01010b3a1201023a01010b3a1201023a01010b3a1201023a01010b3a1201023a01010b3a1201023a01010b3a"
        ),
        bytes(
            hex"ff01ff01ab0101260213012606030113022601131201012602130226021302260113012a0102012a0113120101260213022602130226012a01260103012f012a120101260213022602130226010201260103012f010212010126011301010226021302260113012a0102012a0113120101260113010102260213022601130102012a0102011312010126011301010226021302260213022601131201012601130101022602130226021302260113120101260113010102260213022602130226011312010126011301010226021302260213022601131201012601130101022602130226021302260113"
        ),
        bytes(
            hex"ff01ff01ab010529053b042912010429073403291201032909340229120102290834013b023401291201022901010634013b0134013b02341201022901010734013b03341201022901010734013b03341201022901010b341201022901010b341201022901010a34013b1201023b01010934023b"
        ),
        bytes(
            hex"ff01ff01ab010e0612010906013c0106013c020612010a06023c0106013c12010b06023c01061201020601010706023c02061201020601010606013c0106013c02061201020601010b061201020601010b061201020601010b061201020601010b061201020601010b06"
        ),
        bytes(
            hex"ff01ff01ab010102010301020b251201010301020103012501030125010305250103012512010203032501030225010301250103010201250103120101020203062501030102013b010201251201010301020101012501030125010304250102010301251201020301010225010302250103012501030225010312010102010301010625010304251201010301020101012501030125010305250103012512010203010102250103022501030125010302250103120101020103010106250103042512010103010201010125010301250103052501030125"
        ),
        bytes(
            hex"ff01ff01ab01042e0629042e1201032e0829032e1201022e0729013d012e013d022e1201022e0729032e0129012e1201022e01010629013d012e013d0129012e1201022e01010729012e0229012e1201022e01010a29012e1201022e01010a29012e1201022e01010a29012e1201022e01010a29012e1201022e01010a29012e"
        ),
        bytes(
            hex"ff01ff01ab010303013401030134010301340103013401030134020312010303013401030134010301340103012d0103012d0203120103030134010301340103013402030138030312010303013401030134010301340103012d0103012d0203120102030101020301340103013401030134010301340103012d120102030101012d010301340103013401030134010301340103012d120102030101012d010301340103013401030134010301340103012d120102030101012d010301340103013401030134010301340103012d120102030101012d010301340103013401030134010301340103012d120102030101012d010301340103013401030134010301340203120102340101012d0103013401030134010301340103013401030134"
        ),
        bytes(
            hex"ff01ff01ab010c03021412010b03031412010a0301140103011401031201090302140103011401031201020301010503041402031201020301010403031404031201020301010303031405031201020301010203031406031201020301010103031407031201020301010314080312010203010102140903"
        ),
        bytes(
            hex"ff01ff01ab010c14022912010b1403291201081401030114010301290103012912010914030302291201021401010514022901030329120102140101041402290103012901030229120102140101031408291201021401010214092912010214010101140a291201021401010b291201021401010b29"
        ),
        bytes(
            hex"ff01ff01ab010526053e042612010426073e0326120102260b3e012612010226073e012a0114012a013e0126120102260101063e011401030114013e0126120102260101063e012a0114012a013e0126120102260101073e0114023e01261201022601010a3e01261201022601010a3e01261201022601010a3e01261201022601010a3e0126"
        ),
        bytes(
            hex"ff01ff01ab010e3412010b340103023412010a34013301030133013412010b340133023412010234010102340133033401330334013312010133013401010134033301340333013402331201023301010b331201023301010b331201023301010b331201023301010b331201023301010b33"
        ),
        bytes(
            hex"ff01ff01ab010215010d0315030d0115012d01150134011512010615030d01150303010d1201010d0115010d0115040d0215012d01030134011512010215010d0315010d0115010d01150103010d010301151201021501010215010d0115010d0215012d0103013401151201021501010715012d01150134011512010115010d01010715012d0115013401151201010d01150101020d0415010d012d01150134010d1201021501010115020d0215010d0115012d0115013401151201021501010515010d0115012d010d013401151201010d011501010115010d0415010d012d01150134010d"
        ),
        bytes(
            hex"ff01ff01ab0105140503041412010e1412010914012a0214012a011412010914042a01141201021401010714022a02141201021401010614012a0214012a01141201021401010b141201020701010a14010712010207010109140207120102030101081402070103120102030101071402070203"
        ),
        bytes(
            hex"ff01ff01ab0105370503043712010e3712010b370103023712010a3701030137010301371201023701010837010302371201023701010b371201023701010b371201023701010b371201023701010b371201023701010b371201023701010b37"
        ),
        bytes(
            hex"ff01ff01ab0102360c3212010232083601150336120109320115012901150232120102360832011503321201023201010b361201023201010b321201023601010b321201023201010b361201023201010b321201022901010b321201020301010b36"
        ),
        bytes(
            hex"ff01ff01ab010137011401150114011504370115011401150114013712010137011401150114073701150114013712010e3712010e371201023701010b371201023701010b371201023701010b371201023701010b371201023701010b371201023701010b3712010115010d01010b37"
        ),
        bytes(
            hex"ff01ff01ab0104340703033412010e3412010a34012a0103012a013412010a34030301341201023401010734012a0103012a01341201023401010834012a02341201023401010b341201023401010b341201023401010b341201023401010b341201023401010b34"
        ),
        bytes(
            hex"ff01ff01ab0103070803030712010207060302060103020601071201010704030107020301060303010601071201040303070103020601030206010312010203010102030107020301060303010601031201020301010103010701030107020301070103010702031201020301010703010703031201020301010b031201020301010b031201020301010a03010712010207010109030207"
        ),
        bytes(
            hex"ff01ff01ab01020302340603022e02031201010302340803022e0103120102340703012e0203022e120101340703012e0103012e0203012e1201020301010603012e04031201020301010b031201020301010b031201020301010b031201020301010b031201020301010b031201020301010b03"
        ),
        bytes(
            hex"ff01ff01ab010115013f0115083f0115013f01151201013f01150a3f0115013f1201010d093f0115023f010d1201093f0115013f0115023f1201023f0101063f0315023f1201023f01010b3f1201023f01010b3f1201023f01010b3f1201023f01010b3f1201023f01010a3f012d1201022d0101093f022d"
        ),
        bytes(
            hex"ff01ff01ab010115010d0115010d0115010d0415020d021512010415010d0415010d0107020d01151201010d0215020d0115010d0215010701150107021512010915010d0415120102150101020d0215010d01150107011501070215120102150101010d0315010d011501070115010702151201021501010115010d051501070215010d1201010d01150101010d0415010d0215010d0115010d1201010d01150101010d0415030d031512010115010701010915010701151201020701010215010d0315010d02150207"
        ),
        bytes(
            hex"ff01ff01ab010e2c12010e2c12010b2c0103022c12010a2c0303012c1201022c0101082c0103022c1201022c01010b2c1201022c01010b2c1201022c01010b2c1201022c01010b2c1201022c01010b2c1201022c01010b2c"
        ),
        bytes(
            hex"ff01ff01ab0105030514040312010e0312010b030114020312010a0301140103011401031201020301010803011402031201020301010b031201020301010b031201020301010b031201020301010b031201020301010a03011412010214010109030214"
        ),
        bytes(
            hex"ff01ff01ab010e2912010e29120103290b1412010229051402030514120102290101031401030314010303141201022901010314010307141201022901010414020305141201022901010b141201022901010b291201022901010b291201022901010b29"
        ),
        bytes(
            hex"ff01ff01ab010e0712010e07120109070140010701020107014012010a070140010201400107120102070101080701400207120102070101070701150102011501071201020701010b071201020701010b071201020701010b071201020701010b071201020701010b07"
        ),
        bytes(
            hex"ff01ff01ab0105410542044112010e4112010a41012a0103012a014112010a41012a0103012a01411201024101010841012a02411201024101010b411201024101010b411201024101010b411201024101010b411201024101010b411201024101010b41"
        ),
        bytes(
            hex"ff01ff01ab0109030443010312010e03120108030343022c010312010e0312010203010104030343032c01031201020301010b0312010203010103030343042c01031201020301010b0312010203010102030343052c01031201020301010b0312010203010101030343062c0103"
        ),
        bytes(
            hex"ff01ff01ab0102440333054402330244120101440c330144120109330144012d01140233120109330144012d0114023312010233010106330144012d011402331201023301010b331201023301010b331201023301010b331201023301010b331201023301010b331201023301010b44"
        ),
        bytes(
            hex"ff01ff01ab01014501030145080301450103014512010103014508030114010301450103120101450703011401030114010301140145120109030114010301140203120102030101050301140103021402031201020301010603031402031201020301010703011403031201020301010b031201020301010b031201020301010b031201024501010b03"
        )
    ];

    bytes[] public glasses = [
        bytes(
            hex"ff016b0106460101064613010146044701460101014604480146100104460447034604480146100101460201014604470146010101460448014610010146020101460447014601010146044801461301064601010646ff01"
        ),
        bytes(
            hex"ff016b01064901010649130101490203020201490101014902030202014910010449020302020349020302020149100104490203020203490203020201491001014902010149020302020149010101490203020201491301064901010649ff01"
        ),
        bytes(
            hex"ff016b0106020101060213010102044a010201010102044a010210010402044b0302044b01021001010202010102044c010201010102044c01021001010202010102044d010201010102044d01021301060201010602ff01"
        ),
        bytes(
            hex"ff016b0106020101060213010302014802020101030201480202100110021001010202010102014e0202014f010201010102014e0202014f01021001010202010602010106021301060201010602ff01"
        ),
        bytes(
            hex"ff016b0106020101060213010102020303020101010202030302100104020203050202030302100101020201010202030302010101020203030210010102020101020203030201010102020303021301060201010602ff01"
        ),
        bytes(
            hex"ff016b010650010106501301015002030202015001010150020302020150100104500203020203500203020201501001015002010150020302020150010101500203020201501001015002010150020302020150010101500203020201501301065001010650ff01"
        ),
        bytes(
            hex"ff016b010651010106511301015102030202015101010151020302020151100104510203020203510203020201511001015102010151020302020151010101510203020201511001015102010151020302020151010101510203020201511301065101010651ff01"
        ),
        bytes(
            hex"ff016b010652010106521301015202030202015201010152020302020152100104520203020203520203020201521001015202010152020302020152010101520203020201521001015202010152020302020152010101520203020201521301065201010652ff01"
        ),
        bytes(
            hex"ff016b01060201010602130104020103010201010402010301021001070201030602010301021001010202010602010106021001010202010602010106021301060201010602ff01"
        ),
        bytes(
            hex"ff016b010653010106541301015302030202015301010154020302020154100103550153020302020153015501540203020201541001015402010153020302020153010101540203020201541001015402010153020302020153010101540203020201541301065301010654ff01"
        ),
        bytes(
            hex"ff016b010656010106561301015602030202015601010156020302020156100104560203020203560203020201561001015602010156020302020156010101560203020201561001015602010156020302020156010101560203020201561301065601010656ff01"
        ),
        bytes(
            hex"ff016b010657010106571301015702030202015701010157020302020157100104570203020203570203020201571001015702010157020302020157010101570203020201571001015702010157020302020157010101570203020201571301065701010657ff01"
        ),
        bytes(
            hex"ff016b010658010106581301015802030202015801010158020302020158100104580203020203580203020201581001015802010158020302020158010101580203020201581001015802010158020302020158010101580203020201581301065801010658ff01"
        ),
        bytes(
            hex"ff016b010659010106591301015902030202015901010159020302020159100104590203020203590203020201591001015902010159020302020159010101590203020201591001015902010159020302020159010101590203020201591301065901010659ff01"
        ),
        bytes(
            hex"ff016b01065a0101065a1301015a02030202015a0101015a02030202015a1001045a02030202035a02030202015a1001015a0201015a02030202015a0101015a02030202015a1001015a0201015a02030202015a0101015a02030202015a1301065a0101065aff01"
        ),
        bytes(
            hex"ff016b0106490101065b130101490203020201490101015b02030202015b1001035c0149020302020149015c015b02030202015b1001015b020101490203020201490101015b02030202015b1001015b020101490203020201490101015b02030202015b130106490101065bff01"
        ),
        bytes(
            hex"ff016b01065d0101065d1301015d02030202015d0101015d02030202015d1001045d02030202035d02030202015d1001015d0201015d02030202015d0101015d02030202015d1001015d0201015d02030202015d0101015d02030202015d1301065d0101065dff01"
        ),
        bytes(
            hex"ff016b01065e0101065e1301015e025f0202015e0101015e025f0202015e1001045e025f0202035e025f0202015e1001015e0201015e025f0202015e0101015e025f0202015e1001015e0201015e025f0202015e0101015e025f0202015e1301065e0101065eff01"
        ),
        bytes(
            hex"ff016b010660010106601301016002030202016001010160020302020160100104600203020203600203020201601001016002010160020302020160010101600203020201601001016002010160020302020160010101600203020201601301066001010660ff01"
        ),
        bytes(
            hex"ff016b010657010106571301015702030202015701010157020302020157100104570203020203570203020201571001015702010157020302020157010101570203020201571001015702010157020302020157010101570203020201571301065701010657ff01"
        ),
        bytes(
            hex"ff016b0106610101066213010161020302020161010101620203020201621001030c0161020302020161010c01620203020201621001016102010161020302020161010101620203020201621001016102010161020302020161010101620203020201621301066101010662ff01"
        ),
        bytes(
            hex"ff016b010608010106081301010802030202010801010108020302020108100104080203020203080203020201081001010802010108020302020108010101080203020201081001010802010108020302020108010101080203020201081301060801010608ff01"
        ),
        bytes(
            hex"ff016b0101070115013801630106012c0101012c01060163013801150107130101070115013801630106032c010601630138010d0107100104070115013801630106032c0106016301380115010710010107020101070115013801630106032c0106016301380115010710010107020101070115013801630106012c0101012c010601630138011501071401011501380163010603010106016301380115ff01"
        )
    ];

    struct NounData {
        uint256 head;
        uint256 kit;
        uint256 glasses;
    }

    mapping(uint256 => uint256) public seeds;

    function _saveSeed(uint256 tokenId) internal {
        seeds[tokenId] = uint256(
            keccak256(abi.encodePacked(blockhash(block.number - 1), tokenId))
        );
    }

    function _render(uint256 tokenId) internal view returns (string memory) {
        NounData memory data = _generateNounData(tokenId);

        console.log(data.head, "head index");
        console.log(data.kit, "kit index");
        console.log(data.glasses, "glasses index");

        string memory image = string(
            abi.encodePacked(
                '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" shape-rendering="crispEdges" width="256" height="256">'
                '<rect width="100%" height="100%" fill="',
                backgrounds[0],
                '" />',
                _renderRects(heads[data.head]),
                _renderRects(kits[data.kit]),
                _renderRects(glasses[data.glasses]),
                "</svg>"
            )
        );

        return
            string(
                abi.encodePacked(
                    "data:application/json;base64,",
                    Base64.encode(
                        bytes(
                            abi.encodePacked(
                                '{"image": "data:image/svg+xml;base64,',
                                Base64.encode(bytes(image)),
                                '"}'
                            )
                        )
                    )
                )
            );
    }

    function _renderRects(bytes memory data)
        private
        view
        returns (string memory)
    {
        string[32] memory lookup = [
            "0",
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20",
            "21",
            "22",
            "23",
            "24",
            "25",
            "26",
            "27",
            "28",
            "29",
            "30",
            "31"
        ];

        string memory rects;
        uint256 drawIndex = 0;
        for (uint256 i = 0; i < data.length; i = i + 2) {
            uint8 runLength = uint8(data[i]); // we assume runLength of any non-transparent segment cannot exceed image width (32px)
            uint8 colorIndex = uint8(data[i + 1]);
            if (colorIndex != 0 && colorIndex != 1) {
                // transparent
                uint8 x = uint8(drawIndex % 32);
                uint8 y = uint8(drawIndex / 32);
                string memory color = "#000000";
                if (colorIndex > 1) {
                    color = palette[colorIndex - 1];
                }
                rects = string(
                    abi.encodePacked(
                        rects,
                        '<rect width="',
                        lookup[runLength],
                        '" height="1" x="',
                        lookup[x],
                        '" y="',
                        lookup[y],
                        '" fill="',
                        color,
                        '" />'
                    )
                );
            }
            drawIndex += runLength;
        }

        return rects;
    }

    function _generateNounData(uint256 tokenId)
        private
        view
        returns (NounData memory)
    {
        uint256 seed = seeds[tokenId];
        return
            NounData({
                kit: tokenId % kits.length,
                head: (seed / 2) % heads.length,
                glasses: (seed / 3) % glasses.length
            });
    }
}
